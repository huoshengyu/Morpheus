<launch>
    <!-- simulated robot arguments -->
    <arg name="paused" default="false" />
    <arg name="gazebo_gui" default="false" />
    <arg name="use_rviz" default="true" />

    <!-- launch gazebo -->
    <include file="$(find homestri_a_bot_moveit_config)/launch/gazebo.launch">
        <arg name="paused" value="$(arg paused)" />
        <arg name="gazebo_gui" value="$(arg gazebo_gui)" />
    </include>

    <!-- launch moveit -->
    <include file="$(find homestri_a_bot_moveit_config)/launch/move_group.launch">
        <arg name="allow_trajectory_execution" value="true" />
        <arg name="moveit_controller_manager" value="gazebo" />
        <arg name="fake_execution_type" value="interpolate" />
        <arg name="info" value="true" />
        <arg name="debug" value="false" />
        <arg name="pipeline" value="ompl" />
        <arg name="load_robot_description" value="true" />
    </include>

    <!-- launch rviz -->
    <group if="$(arg use_rviz)">
        <arg name="my_rviz" value="-d $(find homestri_bringup)/rviz/a_bot_gazebo.rviz" />
        <node name="rviz" pkg="rviz" type="rviz" respawn="false" args="$(arg my_rviz)"
            output="screen" />
    </group>

    <param name="use_sim_time" value="true"/>
    <param name="robot_description" textfile="$(find morpheus_teleop)/config/test_urdf.urdf"/>

    <!-- ROS-Pybullet interface -->
    <node pkg="ros_pybullet_interface" name="ros_pybullet_interface" type="ros_pybullet_interface_node.py" output="screen">
        <rosparam param="config" file="$(find morpheus_teleop)/config/test_config.yaml"/>
    </node>
    
    <!-- Static transforms -->
    <node pkg="tf2_ros" type="static_transform_publisher" name="floor_tf" args="0 0 0 0 0 0 rpbi/world rpbi/floor"/>
    <node pkg="tf2_ros" type="static_transform_publisher" name="camera_tf" args="0 -1.5 1.5 0 0 -2.3 rpbi/world rpbi/camera"/>

    <!-- Node that queries joint positions -->
    <node pkg="morpheus_teleop" name="example" type="pybullet_test_control_node.py" output="screen"/>

</launch>